<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-knowledgebases/datasources/Service/DataSyncService" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">DataSyncService | NewRA</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kunjalb2.github.io/newra_documentation/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kunjalb2.github.io/newra_documentation/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kunjalb2.github.io/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="DataSyncService | NewRA"><meta data-rh="true" name="description" content="Code Explanation"><meta data-rh="true" property="og:description" content="Code Explanation"><link data-rh="true" rel="icon" href="/newra_documentation/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kunjalb2.github.io/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService"><link data-rh="true" rel="alternate" href="https://kunjalb2.github.io/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService" hreflang="en"><link data-rh="true" rel="alternate" href="https://kunjalb2.github.io/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService" hreflang="x-default"><link rel="stylesheet" href="/newra_documentation/assets/css/styles.70ff24a8.css">
<script src="/newra_documentation/assets/js/runtime~main.0946f6b9.js" defer="defer"></script>
<script src="/newra_documentation/assets/js/main.d5471f0b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/newra_documentation/"><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/newra_documentation/docs/intro">NewRA</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/newra_documentation/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/newra_documentation/docs/Database">Database</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/newra_documentation/docs/knowledgebases/flow">Knowledgebases</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/newra_documentation/docs/knowledgebases/flow">Flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/newra_documentation/docs/knowledgebases/database">Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/newra_documentation/docs/knowledgebases/AI-settings">AI Settings</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/newra_documentation/docs/knowledgebases/datasources/database">Datasources</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/newra_documentation/docs/knowledgebases/datasources/database">Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/newra_documentation/docs/knowledgebases/datasources/flow">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/newra_documentation/docs/knowledgebases/datasources/types/TextScrapping">Types</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/newra_documentation/docs/knowledgebases/datasources/Service/DatasourceService">Service</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/newra_documentation/docs/knowledgebases/datasources/Service/DatasourceService">DatasourceService</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService">DataSyncService</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/newra_documentation/docs/knowledgebases/datasources/jobs/WebscrapingJob">Jobs</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/newra_documentation/docs/knowledgebases/datasources/listing">listing</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/newra_documentation/docs/knowledgebases/Playground">Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/newra_documentation/docs/knowledgebases/Logs">Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/newra_documentation/docs/knowledgebases/Settings">Settings</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/newra_documentation/docs/apps/database">Apps</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/newra_documentation/docs/setting-module/database">Settings</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/newra_documentation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Knowledgebases</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Datasources</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Service</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">DataSyncService</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>DataSyncService</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="code-explanation">Code Explanation<a class="hash-link" aria-label="Direct link to Code Explanation" title="Direct link to Code Explanation" href="/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService#code-explanation">​</a></h2>
<p>The <code>DataSyncService</code> class is primarily responsible for integrating the application with external Node.js API and Python API. It encapsulates various functions for handling requests related to vectors, Datasources, and chatbots, among others.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="class-variables">Class Variables<a class="hash-link" aria-label="Direct link to Class Variables" title="Direct link to Class Variables" href="/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService#class-variables">​</a></h3>
<p>The class stores various API URL endpoints as class variables for different environments such as Node.js or Python. It also includes <code>EVENT_TYPES</code>, which is a collection of string constants to represent different events as they occur. In addition to those, it has a <code>$nodePostApiHeader</code> which is used for HTTP authorization while making requests to the Node API.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="constructor">Constructor<a class="hash-link" aria-label="Direct link to Constructor" title="Direct link to Constructor" href="/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService#constructor">​</a></h3>
<p>The constructor initializes these URL endpoints and API keys by fetching them from the environment variables.</p>
<p>Sure, let&#x27;s delve deeper into all the methods:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="public-methods">Public Methods<a class="hash-link" aria-label="Direct link to Public Methods" title="Direct link to Public Methods" href="/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService#public-methods">​</a></h3>
<ol>
<li>
<p><code>prepareRequestDataForVector()</code>: This function fetches the file extension from the URL and creates a filtered record of data that conforms to the node&#x27;s vector requirements. The differently named fields in our system are mapped to the expected ones in the node.</p>
</li>
<li>
<p><code>prepareRequestData()</code>: Similar to <code>prepareRequestDataForVector</code>, this method prepares the request payload which we will send for data source creation, update, manual sync, and delete operations to the node/Python server depending on the event type.</p>
</li>
<li>
<p><code>modifyData()</code>: This private method is used by the functions that prepare request data. It takes in data and a fieldMappings array to extract and rename fields as necessary according to the fieldMappings.</p>
</li>
<li>
<p><code>handleVectorRequest()</code>: This method is responsible for making the HTTP POST request to the vectorUrl (Python/Node.js API) with the required vector request payload. It includes the necessary headers, one of which is the authorization key. If the request is successfully executed, it returns the response content.</p>
</li>
<li>
<p><code>playGroundSaveMessage()</code>: This function is responsible for initiating chatbot requests to either Python/Node.js API. If the chat involves audio data, the audio file is attached to the HTTP object before making the POST request to the specified API. It returns the chatbot response on successful execution and logs any exceptions that may occur.</p>
</li>
<li>
<p><code>deleteNamespace()</code>: This function sends a DELETE HTTP request with a payload containing user_id and namespace to the vectorUrl. It is used to remove the specific namespace along with its vectors present in Python/Node.js vector engines.</p>
</li>
<li>
<p><code>getNamespace()</code>: This function is utilized to fetch the namespace of a knowledgebase.</p>
</li>
<li>
<p><code>updateDataSource()</code>: This function is responsible for updating or deleting the datasource in Node.js/Python. It sends a PUT or DELETE request to the Node.js/Python API endpoint depending on the action passed to the function - &#x27;update&#x27; or &#x27;delete&#x27;.</p>
</li>
<li>
<p><code>getKnowledgebaseCategoryLog()</code>: This function retrieves a log list for each knowledgebase category in Node.js/Python. It sends a GET request to the API and returns the data after refining it.</p>
</li>
<li>
<p><code>getKnowledgebaseLog()</code>: This function sends a POST request to Python/Node.js API to fetch the logs associated with the particular knowledgebase.</p>
</li>
<li>
<p><code>getLogBySessionId()</code>: This function fetches logs based on a Session ID by sending a POST request with the payload containing the Session ID to the Python/Node.js API.</p>
</li>
<li>
<p><code>syncDocumentsToNode()</code>: This function is used to sync documents to the Python/Node.js API. It sends a POST request with the provided request data to a specified API for syncing.</p>
</li>
<li>
<p><code>addUserTokenNodeJs()</code>: This function is responsible for adding a user&#x27;s tokens to the Node.js API. It prepares a payload containing the user&#x27;s tokens and initiures a POST request to the Node.js API.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="private-methods">Private Methods<a class="hash-link" aria-label="Direct link to Private Methods" title="Direct link to Private Methods" href="/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService#private-methods">​</a></h3>
<ol>
<li>
<p><code>getPlatformApiUrl()</code>: This function fetches Node.js or Python API URL endpoints from <code>env.production</code> or <code>env.local</code> files based on the running environment.</p>
</li>
<li>
<p><code>getUrl()</code>: This method returns an array of various API URLs such as chat, vector, manage data sources etc. based on specified platform Node.js/Python.</p>
</li>
<li>
<p><code>getAudioContent()</code>: This function checks whether there is audio content in a chat request. If there is, it gets the audio content and returns it along with the original filename.</p>
</li>
<li>
<p><code>getBase64Encoded()</code>: This function base64 encodes data and returns it. Used for the preparation of the API requests where the audio needs to be encoded before sending.</p>
</li>
</ol>
<p>Overall, the class serves as an intermediary between the internal functions of the application and external API services, facilitating data synchronization, request handling, and response acquisition. It represents an effective way to decouple the core application logic from external dependencies.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/knowledgebases/datasources/Service/DataSyncService.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/newra_documentation/docs/knowledgebases/datasources/Service/DatasourceService"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">DatasourceService</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/newra_documentation/docs/knowledgebases/datasources/jobs/WebscrapingJob"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">WebScrappingJob</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService#code-explanation">Code Explanation</a><ul><li><a class="table-of-contents__link toc-highlight" href="/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService#class-variables">Class Variables</a></li><li><a class="table-of-contents__link toc-highlight" href="/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService#constructor">Constructor</a></li><li><a class="table-of-contents__link toc-highlight" href="/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService#public-methods">Public Methods</a></li><li><a class="table-of-contents__link toc-highlight" href="/newra_documentation/docs/knowledgebases/datasources/Service/DataSyncService#private-methods">Private Methods</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>